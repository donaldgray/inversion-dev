<?xml version="1.0" encoding="utf-8" ?>
<objects
	xmlns="http://www.springframework.net"
	xmlns:behaviour="Inversion.Process.Behaviour"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.net http://www.springframework.net/xsd/spring-objects.xsd"
>
	<description>Behaviours</description>

	<!-- 
		behaviours: singletons 
		singletons are the default in Spring, so unless you see
		singleton="false" on an object defination, it's a singleton
	-->

	<object name="request-behaviours" type="BehaviourList">
		<constructor-arg>
			<list  element-type="Inversion.Process.Behaviour.IProcessBehaviour, Inversion.Process">

				<!--<message-trace responds-to="*" xmlns="Inversion.Process.Behaviour">
					<config>
						<item scope="matching-all-param-values" name="area" value="admin" />
						<item scope="matching-all-param-values" name="concern" value="users" />
						<item scope="matching-all-param-values" name="action" value="view" />
					</config>
				</message-trace>-->

				<message-trace responds-to="*" xmlns="Inversion.Process.Behaviour" />

				<!--<simple-sequence responds-to="process-request" xmlns="Inversion.Process.Behaviour">
					<config>
						<sequence>
							<value>bootstrap</value>
							<value>parse-request</value>
							<value>work</value>
							<value>view-state</value>
							<value>process-views</value>
							<value>render</value>
						</sequence>
					</config>
				</simple-sequence>-->

				<object type="Inversion.Process.Behaviour.SimpleSequenceBehaviour, Inversion.Process">
					<constructor-arg name="respondsTo" value="process-request" />
					<constructor-arg name="sequence" ref="life-cycle" />
				</object>

				<object type="Inversion.Web.Behaviour.BootstrapBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="bootstrap" />
					<constructor-arg name="parms">
						<dictionary key-type="string" value-type="string">
							<entry key="area" value="default" />
							<entry key="concern" value="default" />
							<entry key="action" value="default" />
							<entry key="app-path" value="/web.harness" />
						</dictionary>
					</constructor-arg>
				</object>

				<object type="Inversion.Web.Behaviour.ParseRequestBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="parse-request" />
					<constructor-arg name="appDirectory" value="Inversion.Web.Harness.Site" />
				</object>

				<!--<object type="Inversion.Web.Behaviour.AuthenticateBehaviour, Inversion.Web">
					<constructor-arg index="0" value="authenticate" />
				</object>-->

				<object type="Inversion.Web.Behaviour.ViewStateBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="view-state" />
				</object>

				<object type="Inversion.Web.Behaviour.ProcessViewsBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="process-views" />
				</object>

				<object type="Inversion.Web.Behaviour.RenderBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="render" />
				</object>

				<!-- VIEWS -->

				<object type="Inversion.Web.Behaviour.View.RazorViewBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="rzr::view" />
				</object>

				<object type="Inversion.Web.Behaviour.View.XmlViewBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="xml::view" />
					<constructor-arg name="contentType" value="text/xml" />
				</object>

				<object type="Inversion.Web.Behaviour.View.JsonViewBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="json::view" />
					<constructor-arg name="contentType" value="text/json" />
				</object>

				<object type="Inversion.Web.Behaviour.View.XsltViewBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="xslt::view" />
					<constructor-arg name="contentType" value="text/xml" />
				</object>

				<object type="Inversion.Web.Behaviour.View.XsltViewBehaviour, Inversion.Web">
					<constructor-arg name="respondsTo" value="xsl::view" />
					<constructor-arg name="contentType" value="text/html" />
				</object>

				<object type="Inversion.DotLiquid.Behaviour.View.DotLiquidViewBehaviour, Inversion.DotLiquid">
					<constructor-arg name="respondsTo" value="liquid::view" />
					<constructor-arg name="contentType" value="text/html" />
				</object>

				<object type="Inversion.StringTemplate.Behaviour.View.StringTemplateViewBehaviour, Inversion.StringTemplate">
					<constructor-arg name="respondsTo" value="st::view" />
					<constructor-arg name="contentType" value="text/html" />
				</object>

				<!-- app -->

				<message-sequence responds-to="work" xmlns="Inversion.Process.Behaviour">
					<match>
						<all-param-values area="default" concern="default" action="hello" />
					</match>
					<fire>
						<tm-get-topic topic-slot="current-topic" />
						<tm-get-related-for-topic topic-slot="current-topic" related-slot="current-topic-related" />
						<tm-resolve-related-topics related-slot="current-topic-related" relation-type="blog" />
						<tm-resolve-related-topics related-slot="current-topic-related" relation-type="comment" />
					</fire>
				</message-sequence>
				
				<!--[
					["match", "all-param-values", "area", "default"],
					["match", "all-param-values", "concern", "default"],
					["match", "all-param-values", "action", "default"]
				]-->

				<!--<object type="Inversion.Process.Behaviour.ParameterisedSequenceBehaviour, Inversion.Process">
					<constructor-arg name="respondsTo" value="work" />

					<constructor-arg name="namedLists">
						<dictionary key-type="string" value-type="NamedList">
							<entry key="sequence">
								<list element-type="string">
									<value>seq.tm::get-topic</value>
									<value>seq.tm::get-related-for-current-topic</value>
									<value>seq.tm::resolve-comments-for-current-topic</value>
									<value>seq.tm::resolve-blogs-for-current-topic</value>
								</list>
							</entry>
						</dictionary>
					</constructor-arg>

					<constructor-arg name="namedMaps">
						<dictionary key-type="string" value-type="NamedMap">

							<entry key="matching-all-param-values">
								<dictionary key-type="string" value-type="string">
									<entry key="action" value="hello" />
								</dictionary>
							</entry>

							<entry key="seq.tm::get-topic">
								<dictionary key-type="string" value-type="string">
									<entry key="topic-slot" value="current-topic" />
								</dictionary>
							</entry>
							<entry key="seq.tm::get-related-for-current-topic">
								<dictionary key-type="string" value-type="string">
									<entry key="topic-slot" value="current-topic" />
									<entry key="topic-related-slot" value="current-topic-related" />
								</dictionary>
							</entry>
							<entry key="seq.tm::resolve-comments-for-current-topic">
								<dictionary key-type="string" value-type="string">
									<entry key="topic-slot" value="current-topic" />
									<entry key="topic-related-slot" value="current-topic-related" />
								</dictionary>
							</entry>
							<entry key="seq.tm::resolve-blogs-for-current-topic">
								<dictionary key-type="string" value-type="string">
									<entry key="topic-slot" value="current-topic" />
									<entry key="topic-related-slot" value="current-topic-related" />
								</dictionary>
							</entry>
						</dictionary>
					</constructor-arg>

					<constructor-arg name="namedMappedLists">
						<dictionary key-type="string"  value-type="NamedMappedLists">
							<entry key="matching-all-param-values">
								<dictionary key-type="string" value-type="NamedList">
									<entry key="concern">
										<list element-type="string">
											<value>topic</value>
											<value>project</value>
										</list>
									</entry>
								</dictionary>
							</entry>
						</dictionary>
					</constructor-arg>

				</object>-->

			</list>
		</constructor-arg>
	</object>

</objects>